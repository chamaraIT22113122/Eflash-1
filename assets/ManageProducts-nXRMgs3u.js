import{r as i,j as e,a0 as _,aI as M,a3 as K,m as f,K as u,aJ as U,aA as V,aE as W,a4 as X}from"./index-BCTqMaaO.js";import{p}from"./productService-DzsoJYpa.js";/* empty css                       *//* empty css                  */const J="shopCategories",ce=()=>{const[C,S]=i.useState([]),[x,d]=i.useState(!0),[P,r]=i.useState(""),[g,F]=i.useState(()=>{try{const a=localStorage.getItem(J);return a?JSON.parse(a):["clothes","accessories","watch","other"]}catch{return["clothes","accessories","watch","other"]}}),[L,z]=i.useState(!1),[I,A]=i.useState("");i.useEffect(()=>{localStorage.setItem(J,JSON.stringify(g))},[g]);const T=()=>{const a=I.trim();!a||g.includes(a)||(F(c=>[...c,a]),A(""))},B=a=>F(c=>c.filter(t=>t!==a));i.useEffect(()=>{j()},[]);const j=async()=>{try{d(!0),r("");const a=await p.getAllProducts();S(a)}catch{r("Failed to load products. Using offline mode."),S(p.getFallbackProducts())}finally{d(!1)}},[y,N]=i.useState(!1),[n,m]=i.useState(null),[v,b]=i.useState(""),[w,k]=i.useState(""),E={name:"",description:"",price:"",category:"clothes",tags:[],image:"",images:[],inStock:!0,badge:""},[o,h]=i.useState(E),H=async()=>{var a;if(!o.name.trim()){r("⚠️ Please enter a Product Name.");return}if(!o.price||parseFloat(o.price)<=0){r("⚠️ Please enter a valid Price (greater than 0).");return}try{d(!0),r("");const c={...o,price:parseFloat(o.price),tags:o.tags.filter(t=>t.trim()),image:o.image||((a=o.images)==null?void 0:a[0])||""};await p.addProduct(c),await j(),h(E),N(!1)}catch{r("Failed to add product. Please try again.")}finally{d(!1)}},$=async()=>{var a;if(n)try{d(!0),r("");const c=n._id||n.id,t={...n,price:parseFloat(n.price),image:n.image||((a=n.images)==null?void 0:a[0])||""};await p.updateProduct(c,t),await j(),m(null)}catch{r("Failed to update product. Please try again.")}finally{d(!1)}},q=async a=>{if(window.confirm("Are you sure you want to delete this product?"))try{d(!0),r(""),await p.deleteProduct(a),await j()}catch{r("Failed to delete product. Please try again.")}finally{d(!1)}},G=(a,c=!1)=>{Array.from(a.target.files).forEach(t=>{const s=new FileReader;s.onloadend=()=>{c?m(l=>({...l,images:[...l.images||[],s.result]})):h(l=>({...l,images:[...l.images||[],s.result]}))},s.readAsDataURL(t)})},D=(a,c=!1)=>{a.trim()&&(c?(n.tags||[]).includes(a)||m(t=>({...t,tags:[...t.tags||[],a]})):o.tags.includes(a)||h(t=>({...t,tags:[...t.tags,a]})))},Y=(a,c=!1)=>{c?m(t=>({...t,tags:t.tags.filter(s=>s!==a)})):h(t=>({...t,tags:t.tags.filter(s=>s!==a)}))},O=(a,c,t=!1)=>e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"form-section-title",children:"Product Information"}),e.jsxs("div",{className:"form-grid",children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Product Name *"}),e.jsx("input",{type:"text",value:a.name,onChange:s=>c(l=>({...l,name:s.target.value})),placeholder:"e.g. Oversize T-Shirt"})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Price (Rs) *"}),e.jsx("input",{type:"number",min:"0",step:"0.01",value:a.price,onChange:s=>c(l=>({...l,price:s.target.value})),placeholder:"e.g. 2650.00"})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Category"}),e.jsx("input",{type:"text",value:a.category||"",onChange:s=>c(l=>({...l,category:s.target.value})),placeholder:"Type or pick below…"}),g.length>0&&e.jsx("div",{className:"category-chips",children:g.map(s=>e.jsx("button",{type:"button",className:`category-chip${a.category===s?" active":""}`,onClick:()=>c(l=>({...l,category:s})),children:s},s))})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Badge (optional)"}),e.jsx("input",{type:"text",value:a.badge||"",onChange:s=>c(l=>({...l,badge:s.target.value})),placeholder:"e.g. New, Sale, Hot"})]}),e.jsxs("div",{className:"form-group full-width",children:[e.jsx("label",{children:"Description *"}),e.jsx("textarea",{value:a.description,onChange:s=>c(l=>({...l,description:s.target.value})),placeholder:"Product description shown on the shop card",rows:3})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"In Stock"}),e.jsxs("div",{className:"stock-toggle-row",children:[e.jsxs("label",{className:"stock-toggle",children:[e.jsx("input",{type:"checkbox",checked:a.inStock!==!1,onChange:s=>c(l=>({...l,inStock:s.target.checked}))}),e.jsx("span",{className:"toggle-slider"})]}),e.jsx("span",{className:"stock-label",children:a.inStock!==!1?"In Stock":"Out of Stock"})]})]}),e.jsxs("div",{className:"form-group full-width",children:[e.jsx("label",{children:"Tags"}),e.jsxs("div",{className:"tag-input-row",children:[e.jsx("input",{type:"text",value:t?w:v,onChange:s=>t?k(s.target.value):b(s.target.value),onKeyDown:s=>{(s.key==="Enter"||s.key===",")&&(s.preventDefault(),D(t?w:v,t),t?k(""):b(""))},placeholder:"Type tag and press Enter"}),e.jsx("button",{type:"button",className:"btn-add-tag",onClick:()=>{D(t?w:v,t),t?k(""):b("")},children:"Add"})]}),e.jsx("div",{className:"tags-list",children:(a.tags||[]).map(s=>e.jsxs("span",{className:"tag-chip",children:[s,e.jsx("button",{type:"button",onClick:()=>Y(s,t),children:e.jsx(u,{})})]},s))})]}),e.jsxs("div",{className:"form-group full-width",children:[e.jsx("label",{children:"Product Images"}),e.jsx("input",{type:"file",multiple:!0,accept:"image/*",onChange:s=>G(s,t)}),e.jsx("input",{type:"url",value:a.image||"",onChange:s=>c(l=>({...l,image:s.target.value})),placeholder:"Or paste an image URL…",style:{marginTop:"0.5rem"}}),(a.images||[]).length>0&&e.jsx("div",{className:"image-preview-grid",children:(a.images||[]).map((s,l)=>e.jsxs("div",{className:"image-preview-item",children:[e.jsx("img",{src:s,alt:`Preview ${l}`}),e.jsx("button",{type:"button",className:"remove-img-btn",onClick:()=>c(R=>({...R,images:R.images.filter((Z,Q)=>Q!==l)})),children:e.jsx(u,{})})]},l))})]})]})]});return e.jsxs("div",{className:"manage-products admin-page admin-content",children:[e.jsxs("div",{className:"products-header",children:[e.jsxs("h1",{children:[e.jsx(_,{style:{marginRight:"0.5rem"}}),"Manage Shop Products"]}),e.jsxs("div",{className:"header-actions",children:[e.jsxs("button",{className:"manage-categories-btn",onClick:()=>z(a=>!a),children:[e.jsx(M,{})," Manage Categories"]}),!y&&e.jsxs("button",{className:"add-product-btn",onClick:()=>N(!0),children:[e.jsx(K,{})," Add New Product"]})]})]}),L&&e.jsxs(f.div,{className:"category-manager-panel",initial:{opacity:0,y:-10},animate:{opacity:1,y:0},children:[e.jsxs("h3",{children:[e.jsx(M,{})," Shop Categories"]}),e.jsx("p",{className:"category-manager-hint",children:"These categories appear as quick-pick chips when adding/editing a product."}),e.jsxs("div",{className:"category-manager-input-row",children:[e.jsx("input",{type:"text",value:I,onChange:a=>A(a.target.value),onKeyDown:a=>{a.key==="Enter"&&(a.preventDefault(),T())},placeholder:"New category name…"}),e.jsxs("button",{type:"button",className:"btn-add-category",onClick:T,children:[e.jsx(K,{})," Add"]})]}),e.jsxs("div",{className:"category-manager-list",children:[g.length===0&&e.jsx("span",{className:"no-categories",children:"No categories yet."}),g.map(a=>e.jsxs("span",{className:"category-manager-chip",children:[a,e.jsx("button",{type:"button",onClick:()=>B(a),children:e.jsx(u,{})})]},a))]})]}),P&&e.jsx("div",{className:"error-banner",children:P}),x&&e.jsx("div",{className:"loading-banner",children:"Saving…"}),y&&e.jsxs(f.div,{className:"product-form-card",initial:{opacity:0,y:-20},animate:{opacity:1,y:0},children:[e.jsx("h3",{children:"Add New Product"}),O(o,h,!1),e.jsxs("div",{className:"form-actions",children:[e.jsxs("button",{onClick:()=>N(!1),className:"btn-cancel",children:[e.jsx(u,{})," Cancel"]}),e.jsxs("button",{onClick:H,className:"btn-save",disabled:x,children:[e.jsx(U,{})," Add Product"]})]})]}),n&&e.jsx(f.div,{className:"product-form-card edit-modal-overlay",initial:{opacity:0},animate:{opacity:1},children:e.jsxs("div",{className:"edit-modal-inner",children:[e.jsxs("h3",{children:["Edit Product: ",n.name]}),O(n,m,!0),e.jsxs("div",{className:"form-actions",children:[e.jsxs("button",{onClick:()=>m(null),className:"btn-cancel",children:[e.jsx(u,{})," Cancel"]}),e.jsxs("button",{onClick:$,className:"btn-save",disabled:x,children:[e.jsx(U,{})," Save Changes"]})]})]})}),!y&&!n&&e.jsx("div",{className:"shop-products-grid",children:C.map(a=>{var c,t;return e.jsxs(f.div,{className:"shop-product-card",layout:!0,children:[e.jsxs("div",{className:"product-thumb",children:[a.image||(c=a.images)!=null&&c[0]?e.jsx("img",{src:a.image||((t=a.images)==null?void 0:t[0]),alt:a.name}):e.jsxs("div",{className:"no-image",children:[e.jsx(V,{}),e.jsx("span",{children:"No Image"})]}),a.badge&&e.jsx("span",{className:"product-badge",children:a.badge}),a.inStock===!1&&e.jsx("span",{className:"out-of-stock-badge",children:"Out of Stock"})]}),e.jsxs("div",{className:"product-info-block",children:[e.jsx("h3",{children:a.name}),e.jsx("p",{className:"product-cat-label",children:a.category}),e.jsxs("p",{className:"product-price-label",children:["Rs ",parseFloat(a.price||0).toFixed(2)]}),e.jsx("p",{className:"product-desc-preview",children:a.description}),(a.tags||[]).length>0&&e.jsxs("div",{className:"product-tags-row",children:[a.tags.slice(0,3).map(s=>e.jsx("span",{className:"product-tag-chip",children:s},s)),a.tags.length>3&&e.jsxs("span",{className:"product-tag-more",children:["+",a.tags.length-3]})]})]}),e.jsxs("div",{className:"product-card-actions",children:[e.jsx("button",{onClick:()=>m({...a}),className:"btn-edit",title:"Edit",children:e.jsx(W,{})}),e.jsx("button",{onClick:()=>q(a._id||a.id),className:"btn-delete",title:"Delete",children:e.jsx(X,{})})]})]},a._id||a.id)})}),C.length===0&&!y&&!x&&e.jsxs("div",{className:"no-products",children:[e.jsx(_,{size:48}),e.jsx("h3",{children:"No products yet"}),e.jsx("p",{children:'Click "Add New Product" to add your first shop item'})]})]})};export{ce as default};
