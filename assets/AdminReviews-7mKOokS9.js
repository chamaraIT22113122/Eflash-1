import{r,j as e,X as v,$ as g,Y as j,aA as P,aB as $,am as Y,U as q,J as T,m as M,O as G,aa as I,aC as Q,aD as Z,K as U,aE as H,a4 as O}from"./index-BCTqMaaO.js";import{r as u}from"./reviewService-C9IIRXW1.js";/* empty css                  */const te=()=>{const[o,_]=r.useState([]),[n,N]=r.useState("pending"),[w,f]=r.useState(!0),[p,B]=r.useState(""),[t,b]=r.useState(null),[V,y]=r.useState(!1),[l,m]=r.useState(null),[C,z]=r.useState("newest");r.useEffect(()=>{h()},[]);const h=async()=>{try{f(!0);const s=await u.getAllReviews();_(s)}catch(s){console.error("Error loading reviews:",s)}finally{f(!1)}},R=async s=>{try{await u.approveReview(s),await h()}catch(a){console.error("Error approving review:",a)}},k=async s=>{if(window.confirm("Are you sure you want to delete this review? This action cannot be undone."))try{await u.deleteReview(s),await h(),t&&(t.id===s||t._id===s)&&x()}catch(a){console.error("Error deleting review:",a)}},A=s=>{m({...s})},J=async()=>{try{const s=l._id||l.id;await u.updateReview(s,l),m(null),await h()}catch(s){console.error("Error updating review:",s)}},K=()=>{m(null)},F=s=>{b(s),y(!0),document.body.style.overflow="hidden"},x=()=>{b(null),y(!1),document.body.style.overflow=""},W=s=>{markHelpful(s,"admin"),h()},X=s=>{markUnhelpful(s,"admin"),h()},S=o.filter(s=>n==="all"?!0:n==="pending"?!s.approved:n==="approved"?s.approved:!0).filter(s=>{var i,d,D,L;if(!p)return!0;const a=p.toLowerCase();return((i=s.authorName)==null?void 0:i.toLowerCase().includes(a))||((d=s.title)==null?void 0:d.toLowerCase().includes(a))||((D=s.content)==null?void 0:D.toLowerCase().includes(a))||((L=s.authorEmail)==null?void 0:L.toLowerCase().includes(a))}).sort((s,a)=>{switch(C){case"newest":return new Date(a.createdAt)-new Date(s.createdAt);case"oldest":return new Date(s.createdAt)-new Date(a.createdAt);case"rating-high":return a.rating-s.rating;case"rating-low":return s.rating-a.rating;default:return 0}});o.filter(s=>n==="all"?!0:n==="pending"?!s.approved:n==="approved"?s.approved:!0);const c={total:o.length,pending:o.filter(s=>!s.approved).length,approved:o.filter(s=>s.approved).length,withPhotos:o.filter(s=>s.photos&&s.photos.length>0).length,highRated:o.filter(s=>s.rating>=4).length},E=s=>new Date(s).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"});return w?e.jsxs("div",{className:"admin-reviews-loading",children:[e.jsx("div",{className:"spinner"}),e.jsx("p",{children:"Loading reviews..."})]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"admin-reviews admin-page admin-content",children:[e.jsxs("div",{className:"admin-reviews-header",children:[e.jsxs("div",{className:"header-content",children:[e.jsx("h1",{children:"Review Management"}),e.jsx("p",{children:"Moderate, edit, and manage customer reviews"})]}),e.jsx("div",{className:"header-actions",children:e.jsx("button",{className:"refresh-btn",onClick:h,disabled:w,children:"Refresh"})})]}),e.jsxs("div",{className:"review-stats-grid",children:[e.jsxs("div",{className:"stat-card primary",children:[e.jsx("div",{className:"stat-icon",children:e.jsx(v,{})}),e.jsxs("div",{className:"stat-content",children:[e.jsx("span",{className:"stat-value",children:c.total}),e.jsx("span",{className:"stat-label",children:"Total Reviews"})]})]}),e.jsxs("div",{className:"stat-card warning",children:[e.jsx("div",{className:"stat-icon",children:e.jsx(g,{})}),e.jsxs("div",{className:"stat-content",children:[e.jsx("span",{className:"stat-value",children:c.pending}),e.jsx("span",{className:"stat-label",children:"Pending Approval"})]})]}),e.jsxs("div",{className:"stat-card success",children:[e.jsx("div",{className:"stat-icon",children:e.jsx(j,{})}),e.jsxs("div",{className:"stat-content",children:[e.jsx("span",{className:"stat-value",children:c.approved}),e.jsx("span",{className:"stat-label",children:"Approved"})]})]}),e.jsxs("div",{className:"stat-card info",children:[e.jsx("div",{className:"stat-icon",children:e.jsx(P,{})}),e.jsxs("div",{className:"stat-content",children:[e.jsx("span",{className:"stat-value",children:c.withPhotos}),e.jsx("span",{className:"stat-label",children:"With Photos"})]})]}),e.jsxs("div",{className:"stat-card accent",children:[e.jsx("div",{className:"stat-icon",children:e.jsx($,{})}),e.jsxs("div",{className:"stat-content",children:[e.jsx("span",{className:"stat-value",children:c.highRated}),e.jsx("span",{className:"stat-label",children:"4+ Stars"})]})]})]}),e.jsxs("div",{className:"reviews-controls",children:[e.jsx("div",{className:"search-section",children:e.jsxs("div",{className:"search-input-wrapper",children:[e.jsx(Y,{}),e.jsx("input",{type:"text",placeholder:"Search reviews by name, email, or content...",value:p,onChange:s=>B(s.target.value),className:"search-input"})]})}),e.jsxs("div",{className:"filter-section",children:[e.jsxs("div",{className:"filter-buttons",children:[e.jsxs("button",{className:`filter-btn ${n==="all"?"active":""}`,onClick:()=>N("all"),children:["All (",c.total,")"]}),e.jsxs("button",{className:`filter-btn ${n==="pending"?"active":""}`,onClick:()=>N("pending"),children:["Pending (",c.pending,")"]}),e.jsxs("button",{className:`filter-btn ${n==="approved"?"active":""}`,onClick:()=>N("approved"),children:["Approved (",c.approved,")"]})]}),e.jsxs("div",{className:"sort-section",children:[e.jsx(q,{}),e.jsxs("select",{value:C,onChange:s=>z(s.target.value),className:"sort-select",children:[e.jsx("option",{value:"newest",children:"Newest First"}),e.jsx("option",{value:"oldest",children:"Oldest First"}),e.jsx("option",{value:"rating-high",children:"Highest Rating"}),e.jsx("option",{value:"rating-low",children:"Lowest Rating"})]})]})]})]}),e.jsx("div",{className:"reviews-list",children:S.length===0?e.jsxs("div",{className:"no-reviews",children:[e.jsx(v,{size:48}),e.jsx("h3",{children:"No reviews found"}),e.jsx("p",{children:p?`No reviews match "${p}"`:`No ${n!=="all"?n:""} reviews available.`})]}):e.jsx(T,{children:S.map((s,a)=>e.jsxs(M.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},transition:{delay:a*.05},className:`review-card ${s.approved?"approved":"pending"}`,children:[e.jsxs("div",{className:"review-card-header",children:[e.jsxs("div",{className:"reviewer-info",children:[e.jsx("div",{className:"reviewer-avatar",children:e.jsx(G,{})}),e.jsxs("div",{className:"reviewer-details",children:[l&&l.id===s.id?e.jsx("input",{type:"text",value:l.authorName,onChange:i=>m({...l,authorName:i.target.value}),className:"edit-input"}):e.jsx("h3",{children:s.authorName}),e.jsxs("div",{className:"reviewer-meta",children:[e.jsxs("span",{className:"reviewer-email",children:[e.jsx(I,{}),s.authorEmail]}),e.jsxs("span",{className:"review-date",children:[e.jsx(Q,{}),E(s.createdAt)]})]})]})]}),e.jsxs("div",{className:"review-rating-section",children:[e.jsxs("div",{className:"review-rating",children:[[...Array(5)].map((i,d)=>e.jsx(v,{className:d<s.rating?"star-filled":"star-empty"},d)),e.jsxs("span",{className:"rating-number",children:["(",s.rating,"/5)"]})]}),e.jsx("div",{className:`approval-status ${s.approved?"approved":"pending"}`,children:s.approved?e.jsxs(e.Fragment,{children:[e.jsx(j,{}),e.jsx("span",{children:"Approved"})]}):e.jsxs(e.Fragment,{children:[e.jsx(g,{}),e.jsx("span",{children:"Pending"})]})})]})]}),e.jsxs("div",{className:"review-card-body",children:[s.title&&e.jsx("div",{className:"review-title-section",children:l&&l.id===s.id?e.jsx("input",{type:"text",value:l.title,onChange:i=>m({...l,title:i.target.value}),className:"edit-input"}):e.jsx("h4",{children:s.title})}),e.jsx("div",{className:"review-content-section",children:l&&l.id===s.id?e.jsx("textarea",{value:l.content,onChange:i=>m({...l,content:i.target.value}),className:"edit-textarea",rows:3}):e.jsx("p",{children:s.content})}),s.photos&&s.photos.length>0&&e.jsxs("div",{className:"review-photos-section",children:[e.jsxs("div",{className:"photos-header",children:[e.jsx(P,{}),e.jsxs("span",{children:[s.photos.length," Photo",s.photos.length>1?"s":""]})]}),e.jsxs("div",{className:"review-photos-grid",children:[s.photos.slice(0,3).map((i,d)=>e.jsx("div",{className:"review-photo-thumb",onClick:()=>F(s),children:e.jsx("img",{src:i,alt:`Review photo ${d+1}`})},d)),s.photos.length>3&&e.jsxs("div",{className:"photo-count-more",children:["+",s.photos.length-3," more"]})]})]}),e.jsxs("div",{className:"review-helpfulness",children:[e.jsx("span",{className:"helpful-label",children:"Helpfulness:"}),e.jsxs("div",{className:"helpful-votes",children:[e.jsxs("button",{className:"helpful-btn",onClick:()=>W(s.id),children:[e.jsx($,{}),e.jsx("span",{children:s.helpful||0})]}),e.jsxs("button",{className:"unhelpful-btn",onClick:()=>X(s.id),children:[e.jsx(Z,{}),e.jsx("span",{children:s.unhelpful||0})]})]})]})]}),e.jsx("div",{className:"review-card-actions",children:l&&l.id===s.id?e.jsxs("div",{className:"edit-actions",children:[e.jsxs("button",{className:"btn-save",onClick:J,children:[e.jsx(j,{}),"Save Changes"]}),e.jsxs("button",{className:"btn-cancel",onClick:K,children:[e.jsx(U,{}),"Cancel"]})]}):e.jsxs("div",{className:"action-buttons",children:[e.jsx("button",{className:"btn-view",onClick:()=>F(s),title:"View Details",children:e.jsx(g,{})}),e.jsx("button",{className:"btn-edit",onClick:()=>A(s),title:"Edit Review",children:e.jsx(H,{})}),!s.approved&&e.jsx("button",{className:"btn-approve",onClick:()=>R(s.id),title:"Approve Review",children:e.jsx(j,{})}),e.jsx("button",{className:"btn-delete",onClick:()=>k(s.id),title:"Delete Review",children:e.jsx(O,{})})]})})]},s.id))})})]}),e.jsx(T,{children:V&&t&&e.jsx("div",{className:"modal-overlay",onClick:x,children:e.jsxs(M.div,{className:"review-modal",initial:{opacity:0,scale:.8},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.8},onClick:s=>s.stopPropagation(),children:[e.jsxs("div",{className:"modal-header",children:[e.jsx("h2",{children:"Review Details"}),e.jsx("button",{className:"modal-close",onClick:x,children:e.jsx(U,{})})]}),e.jsxs("div",{className:"modal-body",children:[e.jsxs("div",{className:"modal-review-info",children:[e.jsxs("div",{className:"modal-reviewer",children:[e.jsx("strong",{children:t.authorName}),e.jsx("span",{children:t.authorEmail}),e.jsx("span",{children:E(t.createdAt)})]}),e.jsx("div",{className:"modal-rating",children:[...Array(5)].map((s,a)=>e.jsx(v,{className:a<t.rating?"star-filled":"star-empty"},a))})]}),t.title&&e.jsx("h3",{className:"modal-review-title",children:t.title}),e.jsx("p",{className:"modal-review-content",children:t.content}),t.photos&&t.photos.length>0&&e.jsxs("div",{className:"modal-photos-section",children:[e.jsx("h4",{children:"Customer Photos"}),e.jsx("div",{className:"modal-photos-grid",children:t.photos.map((s,a)=>e.jsx("img",{src:s,alt:`Review photo ${a+1}`,className:"modal-photo"},a))})]}),e.jsx("div",{className:"modal-helpfulness",children:e.jsxs("div",{className:"helpfulness-stats",children:[e.jsxs("span",{children:["ðŸ‘ ",t.helpful||0," helpful"]}),e.jsxs("span",{children:["ðŸ‘Ž ",t.unhelpful||0," unhelpful"]})]})})]}),e.jsxs("div",{className:"modal-actions",children:[!t.approved&&e.jsxs("button",{className:"btn-approve",onClick:()=>{R(t.id),x()},children:[e.jsx(j,{}),"Approve Review"]}),e.jsxs("button",{className:"btn-edit",onClick:()=>{A(t),x()},children:[e.jsx(H,{}),"Edit Review"]}),e.jsxs("button",{className:"btn-delete",onClick:()=>k(t.id),children:[e.jsx(O,{}),"Delete Review"]})]})]})})})]})};export{te as default};
